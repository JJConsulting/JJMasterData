document.addEventListener("DOMContentLoaded",(function(){bootstrapVersion=$.fn.tooltip.Constructor.VERSION.charAt(0),jjloadform("load")}));class JJDataExp{static setLoadMessage(){const options={lines:13,length:38,width:17,radius:45,scale:.2,corners:1,color:"#000",opacity:.3,rotate:0,direction:1,speed:1.2,trail:62,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};var target=document.getElementById("impSpin"),spinner=new Spinner(options).spin(target)}static checkProcess(objname,intervalId){showWaitOnPost=!1;var form,formUrl=$("form").attr("action");formUrl.includes("?")?formUrl+="&t=tableexp":formUrl+="?t=tableexp",formUrl+="&gridName="+objname,formUrl+="&exptype=checkProcess",fetch(formUrl).then(response=>response.json()).then((function(data){if(data.FinishedMessage){clearInterval(intervalId),showWaitOnPost=!0,$("#export_modal_"+objname+" .modal-body").html(data.FinishedMessage),$("#dataexp_spinner_"+objname).hide();var linkFile=$("#export_link_"+objname)[0];linkFile&&linkFile.click()}else $("#divMsgProcess").css("display",""),$(".progress-bar").css("width",data.PercentProcess+"%").text(data.PercentProcess+"%"),$("#lblStartDate").text(data.StartDate),$("#lblResumeLog").text(data.Message)}))}static startProcess(objname){JJDataExp.setLoadMessage();let intervalId=setInterval((function(){JJDataExp.checkProcess(objname,intervalId)}),3e3)}static stopProcess(objid,stopStr){$("#divMsgProcess").html(stopStr),showWaitOnPost=!1;var frm,surl=$("form").attr("action");surl.includes("?")?surl+="&t=tableexp":surl+="?t=tableexp",surl+="&gridName="+objid,surl+="&exptype=stopProcess",fetch(surl)}static openExportUI(objid){var frm=$("form"),surl=frm.attr("action");surl.includes("?")?surl+="&t=tableexp":surl+="?t=tableexp",surl+="&gridName="+objid,surl+="&exptype=showoptions",$.ajax({async:!0,type:frm.attr("method"),url:surl,success:function(data){var modalBody="#export_modal_"+objid+" .modal-body ";$(modalBody).html(data),jjloadform(null,modalBody);var qtdElement=$("#"+objid+"_totrows"),totRows;qtdElement.length>0&&(+qtdElement.text().replace(".","").replace(".","").replace(".","").replace(".","")>5e4&&$("#warning_exp_"+objid).show());if(bootstrapVersion<5)$("#export_modal_"+objid).modal();else{const modal=new bootstrap.Modal("#export_modal_"+objid,{});modal.show()}},error:function(jqXHR,textStatus,errorThrown){console.log(errorThrown),console.log(textStatus),console.log(jqXHR)}})}static doExport(objid){var frm=$("form"),surl=frm.attr("action");surl.includes("?")?surl+="&t=tableexp":surl+="?t=tableexp",surl+="&gridName="+objid,surl+="&exptype=export",$.ajax({async:!0,type:frm.attr("method"),url:surl,data:frm.serialize(),success:function(data){var modalBody="#export_modal_"+objid+" .modal-body ";$(modalBody).html(data),jjloadform(null,modalBody)},error:function(jqXHR,textStatus,errorThrown){console.log(errorThrown),console.log(textStatus),console.log(jqXHR)}})}}class JJDataImp{static setLoadMessage(){const options={lines:13,length:38,width:17,radius:45,scale:.2,corners:1,color:"#000",opacity:.3,rotate:0,direction:1,speed:1.2,trail:62,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"},target=document.getElementById("impSpin");new Spinner(options).spin(target)}static checkProcess(objname){showWaitOnPost=!1;const form=$("form");let url=form.attr("action");url.includes("?")?url+="&t=ajaxdataimp&current_uploadaction=process_check&objname="+objname:url+="?t=ajaxdataimp&current_uploadaction=process_check&objname="+objname,$.ajax({url:url,dataType:"json",cache:!1,success:function(result){$("#divMsgProcess").css("display",""),$(".progress-bar").css("width",result.PercentProcess+"%").text(result.PercentProcess+"%"),$("#lblResumeLog").text(result.Message),$("#lblStartDate").text(result.StartDate),result.Insert>0&&($("#lblInsert").css("display",""),$("#lblInsertCount").text(result.Insert)),result.Update>0&&($("#lblUpdate").css("display",""),$("#lblUpdateCount").text(result.Update)),result.Delete>0&&($("#lblDelete").css("display",""),$("#lblDeleteCount").text(result.Delete)),result.Ignore>0&&($("#lblIgnore").css("display",""),$("#lblIgnoreCount").text(result.Ignore)),result.Error>0&&($("#lblError").css("display",""),$("#lblErrorCount").text(result.Error)),result.IsProcessing||($("#current_uploadaction").val("process_finished"),$("form:first").submit())}})}static startProcess(objname){this.setLoadMessage(),setInterval((function(){JJDataImp.checkProcess(objname)}),3e3)}static stopProcess(objname,stopStr){$("#divMsgProcess").html(stopStr),showWaitOnPost=!1;const form=$("form");let url=form.attr("action");url.includes("?")?url+="&t=ajaxdataimp&current_uploadaction=process_stop&objname="+objname:url+="?t=ajaxdataimp&current_uploadaction=process_stop&objname="+objname,$.ajax({url:url,dataType:"json",cache:!1})}}var jjdictionary={deleteAction:function(actionName,url,questionStr){let confirmed;1==confirm(questionStr)&&$.ajax({type:"POST",url:url,success:function(response){response.success&&$("#"+actionName).remove()},error:function(xhr,status,error){if(messageWait.hide(),""!=xhr.responseText){var err=JSON.parse(xhr.responseText);messageBox.show("JJMasterData",err.message,4)}else console.log(xhr)}})},doActionSortable:function(context,url,errorStr){$("#sortable_"+context).sortable({update:function(){var order=$(this).sortable("toArray");$.ajax({type:"POST",url:url,data:{orderFields:order,context:context},success:function(response){response.success||messageBox.show("JJMasterData",errorStr,4)},error:function(xhr,status,error){if(messageWait.hide(),""!=xhr.responseText){var err=JSON.parse(xhr.responseText);401==err.status?document.forms[0].submit():messageBox.show("JJMasterData",err.message,4)}else messageBox.show("JJMasterData",errorStr,4)}})}}).disableSelection()},setDisableAction:function(isDisable,url,errorStr){$.ajax({type:"POST",url:url,data:{value:isDisable},success:function(response){response.success||messageBox.show("JJMasterData",errorStr,4)},error:function(xhr,status,error){if(messageWait.hide(),""!=xhr.responseText){var err=JSON.parse(xhr.responseText);401==err.status?document.forms[0].submit():messageBox.show("JJMasterData",err.message,4)}else messageBox.show("JJMasterData",errorStr,4)}})},refreshAction:function(isPopup=!1){isPopup?window.parent.popup.hide():popup.hide(),messageWait.show(),document.forms[0].submit()},postAction:function(url){messageWait.show(),$("form:first").attr("action",url).submit()},exportElement:function(id,url,validStr){var values;if(""==$("#selectedrows_"+id).val())return messageBox.show("JJMasterData",validStr,3),!1;var form=$("form:first"),originAction=$("form:first").attr("action");return form.attr("action",url),form.submit(),setTimeout((function(){form.attr("action",originAction),messageWait.hide()}),2e3),!0}};function jjloadform(event,prefixSelector){void 0===prefixSelector&&(prefixSelector=""),$(prefixSelector+".selectpicker").selectpicker("render"),$(prefixSelector+"input[type=checkbox][data-toggle^=toggle]").bootstrapToggle(),$(prefixSelector+".jjform-datetime").flatpickr({enableTime:!0,wrap:!0,allowInput:!0,altInput:!0,altFormat:"pt"===localeCode?"d/m/Y H:i":"m/d/Y H:i",dateFormat:"pt"===localeCode?"d-m-Y H:i":"m-d-Y H:i",onOpen:function(selectedDates,dateStr,instance){instance.setDate(Date.now())},locale:localeCode}),$(prefixSelector+".jjform-date").flatpickr({enableTime:!1,wrap:!0,allowInput:!0,altInput:!0,altFormat:"pt"===localeCode?"d/m/Y":"m/d/Y",dateFormat:"pt"===localeCode?"d-m-Y":"m-d-Y",onOpen:function(selectedDates,dateStr,instance){instance.setDate(Date.now())},locale:localeCode}),$(prefixSelector+".jjform-hour").flatpickr({enableTime:!0,wrap:!0,noCalendar:!0,allowInput:!0,altInput:!0,dateFormat:"H:i",onOpen:function(selectedDates,dateStr,instance){instance.setDate(Date.now())},locale:localeCode}),$(prefixSelector+".jjdecimal").each((function(){var decimalPlaces=$(this).attr("jjdecimalplaces");null==decimalPlaces&&(decimalPlaces="2"),$(this).number(!0,decimalPlaces,",",".")})),$(prefixSelector+"[data-toggle='tooltip']").tooltip({container:"body",trigger:"hover"}),JJTextArea.setup(),JJSearchBox.setup(),JJLookup.setup(),JJSortable.setup(),JJUpload.setup(),JJSlider.observeSliders(),JJSlider.observeInputs(),messageWait.hide(),$(document).on({ajaxSend:function(event,jqXHR,settings){if(null!=settings.url&&-1!==settings.url.indexOf("t=jjsearchbox"))return null;showWaitOnPost&&messageWait.show()},ajaxStop:function(){messageWait.hide()}}),$("form").on("submit",(function(){showWaitOnPost&&setTimeout((function(){messageWait.show()}),1)}))}class JJLookup{static setup(){$("input.jjlookup").each((function(){let lookupInput=$(this),lookupId=lookupInput.attr("id"),panelName=lookupInput.attr("pnlname"),popupTitle=lookupInput.attr("popuptitle"),popupSize=+lookupInput.attr("popupsize"),form=$("form"),url=form.attr("action");url.includes("?")?url+="&":url+="?",url+="jjlookup_",url+=panelName+"="+lookupId,$("#btn_"+lookupId).on("click",(function(){let ajaxUrl=url+"&lkaction=geturl&lkid="+lookupInput.val();return $.ajax({type:"POST",data:form.serialize(),dataType:"json",cache:!1,url:ajaxUrl,success:function(data){popup.show(popupTitle,data.url,popupSize)},error:function(jqXHR,textStatus,errorThrown){console.log(errorThrown),console.log(textStatus),console.log(jqXHR)}}),!1})),lookupInput.on("focus",(function(){lookupInput.val($("#id_"+lookupId).val()).removeAttr("readonly").select()})),lookupInput.on("change",(function(){$("#id_"+lookupId).val(lookupInput.val())})),lookupInput.on("blur",(function(){if(showWaitOnPost=!1,$("#id_"+lookupId).val(lookupInput.val()),$("#st_"+lookupId).removeClass("fa-check").removeClass("fa-exclamation-triangle").removeClass("fa-ellipsis-h").removeClass("fa-times"),lookupInput.removeAttr("readonly"),""==lookupInput.val())return;lookupInput.addClass("loading-circle");const ajaxUrl=url+"&lkaction=ajax&lkid="+lookupInput.val();$.ajax({type:"POST",data:form.serialize(),dataType:"json",cache:!1,url:ajaxUrl,success:function(data){showWaitOnPost=!0,lookupInput.removeClass("loading-circle"),""==data.description?($("#st_"+lookupId).removeClass("fa fa-check").addClass("fa fa-exclamation-triangle"),lookupInput.removeAttr("readonly")):($("#st_"+lookupId).removeClass("fa fa-exclamation-triangle").removeClass("fa fa-ellipsis-h").addClass("fa fa-check"),lookupInput.attr("readonly","readonly").val(data.description))},error:function(jqXHR,textStatus,errorThrown){showWaitOnPost=!0,lookupInput.removeClass("loading-circle"),$("#st_"+lookupId).removeClass("fa fa-check").addClass("fa fa-times"),console.log(errorThrown),console.log(textStatus),console.log(jqXHR)}})}))}))}}class JJSearchBox{static setup(){$("input.jjsearchbox").each((function(){var objid=$(this).attr("jjid"),pnlname=$(this).attr("pnlname"),triggerlength=$(this).attr("triggerlength"),numberofitems=$(this).attr("numberofitems"),scrollbar=Boolean($(this).attr("scrollbar")),showimagelegend=Boolean($(this).attr("showimagelegend"));null==triggerlength&&(triggerlength="1"),null==numberofitems&&(numberofitems="10"),null==scrollbar&&(scrollbar=!1),null==showimagelegend&&(showimagelegend=!1);var frm=$("form"),urltypehead=frm.attr("action");urltypehead.includes("?")?urltypehead+="&":urltypehead+="?",urltypehead+="t=jjsearchbox",urltypehead+="&objname="+objid,urltypehead+="&pnlname="+pnlname,$(this).blur((function(){""==$(this).val()&&($("#st_"+objid).removeClass("fa-check").removeClass("fa-exclamation-triangle"),$("#"+objid).val(""))})),$(this).typeahead({ajax:{url:urltypehead,method:"POST",loadingClass:"loading-circle",triggerLength:triggerlength,preDispatch:function(){var data;return $("#"+objid).val(""),$("#st_"+objid).removeClass("fa-check").removeClass("fa-exclamation-triangle "),frm.serializeArray()}},onSelect:function(item){$("#"+objid).val(item.value),""!=item.value&&$("#st_"+objid).removeClass("fa-exclamation-triangle ").addClass("fa fa-check")},displayField:"name",valueField:"id",triggerLength:triggerlength,items:numberofitems,scrollBar:scrollbar,item:'<li class="dropdown-item"><a href="#"></a></li>',highlighter:function(item){var query=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),textSel;if(showimagelegend){var parts=item.split("|");textSel=parts[0].replace(new RegExp("("+query+")","ig"),(function($1,match){return"<strong>"+match+"</strong>"})),textSel="<i class='fa fa-lg fa-fw "+parts[1]+"' style='color:"+parts[2]+";margin-right:6px;'></i>"+textSel}else textSel=item.replace(new RegExp("("+query+")","ig"),(function($1,match){return"<strong>"+match+"</strong>"}));return textSel}})}))}}class JJSlider{static observeSliders(){let sliders=document.getElementsByClassName("jjslider");Array.from(sliders).forEach(slider=>{let sliderInput=document.getElementById(slider.id+"-value");document.getElementById(slider.id).addEventListener("change",(function(){this.setAttribute("value",this.value)})),slider.oninput=function(){sliderInput.value=this.value}})}static observeInputs(){let inputs=document.getElementsByClassName("jjslider-value");Array.from(inputs).forEach(input=>{let slider=document.getElementById(input.id.replace("-value",""));input.oninput=function(){slider.value=this.value}})}}class JJSortable{static setup(){$(".jjsortable").sortable({helper:function(e,tr){var $originals=tr.children(),$helper=tr.clone();return $helper.children().each((function(index){$(this).width($originals.eq(index).width())})),$helper},change:function(event,ui){ui.placeholder.css({visibility:"visible",background:"#fbfbfb"})}})}}class JJTextArea{static setup(){$("textarea").keydown((function(){var oTextArea=$(this),iMaxChar=oTextArea.attr("maxlength"),strValid=oTextArea.attr("strvalid2"),strChars=oTextArea.attr("strchars");if(isNaN(iMaxChar)&&(iMaxChar=oTextArea.attr("jjmaxlength")),!isNaN(iMaxChar)&&(isNaN(strValid)&&(strValid="Maximum limit of {0} characters!"),isNaN(strChars)&&(strChars="({0} characters remaining)"),!isNaN(iMaxChar))){var nId=oTextArea.attr("id"),iTypedChar;oTextArea.val().toString().length>iMaxChar&&alert(strValid.replace("{0}",iMaxChar)),strChars=strChars.replace("{0}",iMaxChar-oTextArea.val().toString().length),strChars+="&nbsp;",$("#spansize_"+nId).length?$("#spansize_"+nId).html(strChars):$("<span id='spansize_"+nId+"' class='small' style='float: right'>"+strChars+"</span>").insertBefore(oTextArea)}}))}}class JJUpload{static setup(){$("div.fileUpload").each((function(){let obj=$(this),objid=obj.attr("id"),multiple="true"===obj.attr("jjmultiple"),autoSubmit="true"===obj.attr("autoSubmit"),maxFileSize=obj.attr("maxFileSize"),dragDrop=obj.attr("dragDrop"),copyPaste=obj.attr("copyPaste"),showFileSize=obj.attr("showFileSize"),allowedTypes=obj.attr("allowedTypes"),dragDropStr="<span>&nbsp;<b>"+obj.attr("dragDropStr")+"</b></span>",acceptFiles="*";"*"!=allowedTypes&&(acceptFiles="."+allowedTypes.replace(" ","").replace(",",",."));let frm=$("form"),surl=frm.attr("action");surl.includes("?")?surl+="&t=jjupload":surl+="?t=jjupload",surl+="&objname="+objid;let upload=$("#"+objid).uploadFile({url:surl,formData:frm.serializeArray(),fileName:"file",multiple:multiple,maxFileSize:maxFileSize,maxFileCount:1e3,dragDrop:dragDrop,showFileSize:showFileSize,dragdropWidth:$(this).width()-10,statusBarWidth:$(this).width()-10,autoSubmit:!0,uploadButtonClass:3===bootstrapVersion?"btn btn-default":"btn btn-outline-dark",allowedTypes:allowedTypes,acceptFiles:acceptFiles,uploadStr:obj.attr("uploadStr"),dragDropStr:dragDropStr,doneStr:obj.attr("doneStr"),cancelStr:obj.attr("cancelStr"),abortStr:obj.attr("abortStr"),extErrorStr:obj.attr("extErrorStr"),sizeErrorStr:obj.attr("sizeErrorStr"),customErrorKeyStr:"jquery-upload-file-error",returnType:"json",onSubmit:function(){showWaitOnPost=!1},onSuccess:function(files,data,xhr,pd){var message=data["jquery-upload-file-message"];if(message&&""!=message){var div=$("<div class='ajax-file-upload-filename'></div>");$("<span class='fa fa-check-circle text-success'></span>").appendTo(div),$("<span>&nbsp;"+message+"</span>").appendTo(div),div.appendTo(pd.statusbar[0])}},afterUploadAll:function(obj){autoSubmit&&obj.selectedFiles>0&&($("#uploadaction_"+objid).val("afteruploadall"),$("form:first").submit())}});$(window).resize((function(){$("#"+objid+" .ajax-upload-dragdrop").width($("#"+objid).width()-30+"px")})),"true"==copyPaste&&window.addEventListener("paste",e=>{var files=e.clipboardData.files;if(1==files.length){var file=files[0];if(-1!=file.type.indexOf("image")){$("#btnDoUpload_"+objid).click((function(){$("#preview_modal_"+objid).modal("hide");var filename=$("#preview_filename_"+objid).val();""==filename.trim()&&(filename="image"),filename+=".png";const dt=new DataTransfer,myNewFile=new File([file],filename,{type:file.type});dt.items.add(myNewFile),$("#"+objid+" input[type='file']")[0].files=dt.files,$("#"+objid+" input[type='file']").trigger("change")}));var reader=new FileReader;return reader.onload=function(event){document.getElementById("pastedimage_"+objid).src=event.target.result.toString();var filename=file.name.replace(/\.[^/.]+$/,"");$("#preview_filename_"+objid).val(filename),$("#preview_modal_"+objid).modal()},void reader.readAsDataURL(file)}}let selector="#"+objid+" input[type='file']";$()[0].files=files,$("#"+objid+" input[type='file']").trigger("change")})}))}}var jjview=function(){function tablePost(objid,enableAjax,loadform){if(enableAjax){var frm=$("form"),surl=frm.attr("action");surl.includes("?")?surl+="&t=ajax":surl+="?t=ajax",surl+="&objname="+objid,$.ajax({async:!0,type:frm.attr("method"),url:surl,data:frm.serialize(),success:function(data){"\x3c!--ErrorPage--\x3e"!=data.substring(2,18)?($("#jjgridview_"+objid).html(data),loadform&&jjloadform(),$("#current_filteraction_"+objid).val("")):$("form:first").submit()},error:function(jqXHR,textStatus,errorThrown){console.log(errorThrown),console.log(textStatus),console.log(jqXHR),$("#current_filteraction_"+objid).val("")}})}else $("form:first").submit()}return{showExportOptions:function(objid,exportType){"1"==exportType?($("#"+objid+"_div_export_orientation").hide(),$("#"+objid+"_div_export_all").show(),$("#"+objid+"_div_export_delimiter").hide(),$("#"+objid+"_div_export_fistline").show()):"2"==exportType?($("#"+objid+"_div_export_orientation").show(),$("#"+objid+"_div_export_all").hide(),$("#"+objid+"_div_export_delimiter").hide(),$("#"+objid+"_div_export_fistline").hide()):($("#"+objid+"_div_export_orientation").hide(),$("#"+objid+"_div_export_all").show(),$("#"+objid+"_div_export_delimiter").show(),$("#"+objid+"_div_export_fistline").show())},doClearFilter:function(objid,enableAjax){var divId="#gridfilter_"+objid,selector;$(divId+" input:enabled, "+divId+" select:enabled").each((function(){let currentObj=$(this),inputType=this.type;"checkbox"==inputType?currentObj.prop("checked",!1):"input"!=inputType&&"tagsinput"==currentObj.attr("data-role")?currentObj.tagsinput("removeAll"):"hidden"!=inputType&&(currentObj.val(""),currentObj.hasClass("selectpicker")?currentObj.selectpicker("render"):currentObj.hasClass("jjsearchbox")?currentObj.blur():currentObj.hasClass("jjlookup")&&currentObj.blur())})),$("#current_filteraction_"+objid).val("CLEARACTION"),$("#current_tableaction_"+objid).val(""),$("#current_formaction_"+objid).val(""),tablePost(objid,enableAjax,!1)},doFilter:function(objid,enableAjax){return $("#current_filteraction_"+objid).val("FILTERACTION"),$("#current_tableaction_"+objid).val(""),$("#current_tablepage_"+objid).val("1"),$("#current_formaction_"+objid).val(""),tablePost(objid,enableAjax,!1),!1},doSearch:function(objid,oDom){var value=$(oDom).val().toString().toLowerCase();$("#table_"+objid+" tr").filter((function(){var textValues,isSearch=$(this).clone().find(".bootstrap-select, .selectpicker, select").remove().end().text().toLowerCase().indexOf(value)>-1;if(!isSearch){var valueNew=value.replace(",","").replace(".","").replace("-","");$(this).find("input").each((function(){var inputValue=$(this).val();if(null!=inputValue){let isSearch;if(inputValue.toString().replace(",","").replace(".","").replace("-","").toLowerCase().indexOf(valueNew)>-1)return!1}}))}isSearch||$(this).find("select").each((function(){var selectedText=$(this).children("option:selected").text();if(null!=selectedText&&(isSearch=selectedText.toLowerCase().indexOf(valueNew)>-1))return!1})),$(this).toggle(isSearch)})),value.length>0?($("#infotext_"+objid).css("display","none"),$("ul.pagination").css("display","none")):($("#infotext_"+objid).css("display",""),$("ul.pagination").css("display",""))},doSelectItem:function(objid,obj){var values=$("#selectedrows_"+objid).val().toString(),valuesList=[];if("jjchk_all"!=obj.attr("id")){values.length>0&&(valuesList=values.split(",")),obj.prop("checked")?$.inArray(obj.val(),valuesList)<0&&valuesList.push(obj.val()):valuesList=valuesList.filter((function(item){return item!==obj.val()})),$("#selectedrows_"+objid).val(valuesList);var textInfo="",selectedText=$("#selectedtext_"+objid);textInfo=0==valuesList.length?selectedText.attr("noSelStr"):1==valuesList.length?selectedText.attr("oneSelStr"):selectedText.attr("paramSelStr").replace("{0}",valuesList.length.toString()),selectedText.text(textInfo)}},doUnSelectAll:function(objid){$(".jjselect input").not(":disabled").prop("checked",!1),$("#selectedrows_"+objid).val("");var oSelectedtext=$("#selectedtext_"+objid);oSelectedtext.text(oSelectedtext.attr("noSelStr"))},doSelectAll:function(objid){var frm=$("form"),surl=frm.attr("action");surl.includes("?")?surl+="&t=selectall":surl+="?t=selectall",$.ajax({async:!0,type:frm.attr("method"),url:surl,success:function(data){var aValues=data.split(",");$(".jjselect input").not(":disabled").prop("checked",!0),$("#selectedrows_"+objid).val(aValues);var oSelectedtext=$("#selectedtext_"+objid),promptStr=oSelectedtext.attr("paramSelStr").replace("{0}",aValues.length.toString());oSelectedtext.text(promptStr)},error:function(jqXHR,textStatus,errorThrown){console.log(errorThrown),console.log(textStatus),console.log(jqXHR)}})},doSorting:function(objid,enableAjax,v){var tableOrder="#current_tableorder_"+objid;v+" ASC"==$(tableOrder).val()?$(tableOrder).val(v+" DESC"):$(tableOrder).val(v+" ASC"),$("#current_tableaction_"+objid).val(""),$("#current_formaction_"+objid).val(""),tablePost(objid,enableAjax,!0)},doMultSorting:function(objid){for(var descCommand="",order=$("#sortable_"+objid).sortable("toArray"),i=0;i<order.length;i++){var tipoOrdenacao;switch($("#"+order[i]+"_order").children("option:selected").val()){case"A":descCommand+=order[i]+" ASC,";break;case"D":descCommand+=order[i]+" DESC,"}}descCommand=descCommand.substring(0,descCommand.length-1),$("#current_tableorder_"+objid).val(descCommand),$("#sort_modal_"+objid).modal("hide"),$("#current_formaction_"+objid).val(""),jjview.doRefresh(objid,!0)},doPaging:function(objid,enableAjax,v){$("#current_tablepage_"+objid).val(v),$("#current_tableaction_"+objid).val(""),$("#current_formaction_"+objid).val(""),tablePost(objid,enableAjax,!0)},doRefresh:function(objid,enableAjax){$("#current_tableaction_"+objid).val(""),$("#current_tablerow_"+objid).val(""),$("#current_formaction_"+objid).val(""),tablePost(objid,enableAjax,!0)},doConfigUI:function(objid,criptid){$("#current_tableaction_"+objid).val(criptid),$("#current_tablepage_"+objid).val("1"),$("#current_tablerow_"+objid).val(""),$("#current_formaction_"+objid).val(""),$("form:first").submit()},doConfigCancel:function(objid){$("form").trigger("reset"),$("form :checkbox").change(),$("#config_modal_"+objid).modal("hide")},doSelElementInsert:function(objid,criptid){$("#current_painelaction_"+objid).val("ELEMENTSEL"),$("#current_selaction_"+objid).val(criptid),$("form:first").submit()},formAction:function(objid,criptid,confirmMessage){var result;if(confirmMessage&&!confirm(confirmMessage))return!1;$("#current_tableaction_"+objid).val(""),$("#current_formaction_"+objid).val(criptid),$("form:first").submit()},gridAction:function(objid,criptid,confirmMessage){var result;if(confirmMessage&&!confirm(confirmMessage))return!1;$("#current_tableaction_"+objid).val(criptid),$("#current_formaction_"+objid).val(""),$("form:first").submit()},doPainelAction:function(objid,v){return $("#current_painelaction_"+objid).val(v),$("form").submit(),!1},doFormUrlRedirect:function(objid,criptid,confirmMessage){var result;if(confirmMessage&&!confirm(confirmMessage))return!1;var frm=$("form"),surl=frm.attr("action");surl.includes("?")?surl+="&t=geturlaction&objname="+objid:surl+="?t=geturlaction&objname="+objid,$.ajax({async:!0,type:"POST",url:surl,data:frm.serialize()+"&criptid="+criptid,success:function(data){data.UrlAsPopUp?popup.show(data.TitlePopUp,data.UrlRedirect):window.location.href=data.UrlRedirect},error:function(jqXHR,textStatus,errorThrown){console.log(errorThrown),console.log(textStatus),console.log(jqXHR)}})},doSqlCommand:function(objid,criptid,confirmMessage){var result;if(confirmMessage&&!confirm(confirmMessage))return!1;$("#current_tableaction_"+objid).val(""),$("#current_formaction_"+objid).val(""),$("#current_tablerow_"+objid).val(criptid),$("form:first").submit()},showInsertSucess:function(objid){$("#pnl_insertmsg_"+objid).fadeOut(2e3,(function(){$("#pnl_insert_"+objid).slideDown()}))},doUrlRedirect:function(url,ispopup,title,confirmMessage){var result;if(confirmMessage&&!confirm(confirmMessage))return!1;ispopup?popup.show(title,url):window.location.href=url},setLookup:function(objid,value){window.parent.popup.hide(),setTimeout((function(){window.parent.$("#id_"+objid).val(value),window.parent.$("#"+objid).val(value).change().blur()}),100)},deleteFile:function(objid,filename,promptStr){var result;if(!confirm(promptStr))return!1;$("#uploadaction_"+objid).val("DELFILE"),$("#filename_"+objid).val(filename),$("form:first").submit()},downloadFile:function(objid,filename){$("#uploadaction_"+objid).val("DOWNLOADFILE"),$("#filename_"+objid).val(filename),$("form:first").submit(),setTimeout((function(){messageWait.hide(),$("#uploadaction_"+objid).val("")}),1500)},renameFile:function(objid,filename,promptStr){var newFileName=prompt(promptStr,filename);null!=newFileName&&newFileName!=filename&&($("#uploadaction_"+objid).val("RENAMEFILE"),$("#filename_"+objid).val(filename+";"+newFileName),$("form:first").submit())},openUploadForm:function(objid,title,values){var pnlname=$("#v_"+objid).attr("pnlname"),surl=$("form").attr("action");surl+=surl.includes("?")?"&":"?",surl+="jjuploadform_"+pnlname+"="+objid,surl+="&uploadvalues="+values,popup.show(title,surl)},directDownload:function(objid,pnlname,filename){messageWait.show();var url=$("form").attr("action");url+=url.includes("?")?"&":"?",url+="jjuploadform_"+pnlname+"="+objid,url+="&downloadfile="+filename,window.location.assign(url),setTimeout((function(){messageWait.hide()}),1500)},viewLog:function(objid,id){$("#viewid_"+objid).val(id),$("form:first").submit()},loadFrameLog:function(objId,logId){$("#sortable_grid a").removeClass("active"),""!=logId&&$("#"+logId).addClass("active"),$("#viewid_"+objId).val(logId);var frm=$("form"),surl=frm.attr("action");surl.includes("?")?surl+="&t=ajax":surl+="?t=ajax",$.post(surl,frm.serialize(),(function(data){$("#jjpainellog_loghistory").html(data)}))}}}(),messageBox=function(){const TMessageIcon_NONE=1,TMessageIcon_INFO=2,TMessageIcon_WARNING=3,TMessageIcon_ERROR=4,TMessageIcon_QUESTION=5,TMessageSize_SMALL=1,TMessageSize_DEFAULT=2,TMessageSize_LARGE=3;var jQueryModalId="#site-modal",jQueryModalTitleId="#site-modal-title",jQueryModalContentId="#site-modal-content",jQueryModalButton1Id="#site-modal-btn1",jQueryModalButton2Id="#site-modal-btn2",modalId="#site-modal".substring(1),button1Id="#site-modal-btn1".substring(1);function setTitle(title){$(jQueryModalTitleId).html(title)}function setContent(content){$(jQueryModalContentId).html(content)}function showModal(){if(bootstrapVersion<5)$("#site-modal").modal().on("shown.bs.modal",(function(){$("#site-modal-btn1").focus()}));else{const modal=new bootstrap.Modal(document.getElementById(modalId),{});modal.show(),modal.addEventListener("shown.bs.modal",(function(){document.getElementById(button1Id).focus()}))}}function setBtn1(label,func){$("#site-modal-btn1").text(label),$.isFunction(func)&&$("#site-modal-btn1").on("click.siteModalClick1",func),$("#site-modal-btn1").show()}function setBtn2(label,func){$("#site-modal-btn2").text(label),$.isFunction(func)&&$("#site-modal-btn2").on("click.siteModalClick2",func),$("#site-modal-btn2").show()}function reset(){setTitle(""),setContent(""),$("#site-modal-btn1").text(""),$("#site-modal-btn1").off("click.siteModalClick1"),$("#site-modal-btn2").text(""),$("#site-modal-btn2").off("click.siteModalClick2")}function loadHtml(icontype,sizetype){$("#site-modal").length&&$("#site-modal").remove();var html="";html+='<div id="site-modal" tabindex="-1" class="modal fade" role="dialog">\r\n',html+='  <div class="modal-dialog',sizetype==TMessageSize_LARGE?html+=" modal-lg":sizetype==TMessageSize_SMALL&&(html+=" modal-sm"),html+='" role="document">\r\n',html+='    <div class="modal-content">\r\n',html+='      <div class="modal-header">\r\n',bootstrapVersion>=4?html+='        <h4 id="site-modal-title" class="modal-title"></h4>\r\n':bootstrapVersion>=5?html+='        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>\r\n':3==bootstrapVersion&&(html+='        <h4 id="site-modal-title" class="modal-title"><button type="button" class="close" data-dismiss="modal">&times;</button></h4>\r\n'),html+="      </div>\r\n",html+='      <div class="modal-body">\r\n',html+='        <table border="0">\r\n',html+="          <tr>\r\n",html+='            <td style="width:40px">\r\n',icontype==TMessageIcon_ERROR?(html+='              <span class="text-danger">\r\n',html+='                <span class="fa fa-times-circle" aria-hidden="true" style="font-size: 30px;"></span>\r\n',html+="              </span>\r\n"):icontype==TMessageIcon_WARNING?(html+='              <span class="text-warning">\r\n',html+='                <span class="fa fa-exclamation-triangle " aria-hidden="true" style="font-size: 30px;"></span>\r\n',html+="              </span>\r\n"):icontype==TMessageIcon_INFO?(html+='              <span class="text-info">\r\n',html+='                <span class="fa fa-info-circle" aria-hidden="true" style="font-size: 30px;"></span>\r\n',html+="              </span>\r\n"):icontype==TMessageIcon_QUESTION&&(html+='              <span class="text-info">\r\n',html+='                <span class="fa fa-question-circle" aria-hidden="true" style="font-size: 30px;"></span>\r\n',html+="              </span>\r\n"),html+="            </td>\r\n",html+="            <td>\r\n",html+='              <span id="site-modal-content"></span>\r\n',html+="            </td>\r\n",html+="          </tr>\r\n",html+="        </table>\r\n",html+="      </div>\r\n",html+='      <div class="modal-footer">\r\n',3==bootstrapVersion?(html+='        <button type="button" id="site-modal-btn1" class="btn btn-default" data-dismiss="modal"></button>\r\n',html+='        <button type="button" id="site-modal-btn2" class="btn btn-default" data-dismiss="modal"></button>\r\n'):4==bootstrapVersion?(html+='        <button type="button" id="site-modal-btn1" class="btn btn-outline-dark" data-dismiss="modal"></button>\r\n',html+='        <button type="button" id="site-modal-btn2" class="btn btn-outline-dark" data-dismiss="modal"></button>\r\n'):(html+='        <button type="button" id="site-modal-btn1" class="btn btn-outline-dark" data-bs-dismiss="modal"></button>\r\n',html+='        <button type="button" id="site-modal-btn2" class="btn btn-outline-dark" data-bs-dismiss="modal"></button>\r\n'),html+="      </div>\r\n",html+="    </div>\r\n",html+="  </div>\r\n",html+="</div>\r\n",$("body").append(html)}return{show:function(title,content,icontype,sizetype,btn1Label,btn1Func,btn2Label,btn2Func){reset(),loadHtml(icontype,sizetype),setTitle(title),setContent(content),void 0===btn1Label?setBtn1("Fechar",null):setBtn1(btn1Label,btn1Func),void 0===btn2Label?$("#site-modal-btn2").hide():setBtn2(btn2Label,btn2Func),showModal()},hide:function(){$("#site-modal").modal("hide"),$(".modal-backdrop").hide()}}}(),messageWait=function(){var htmlIdWaitModal="#jjform_wait_message";function loadHtml(){if(!$(htmlIdWaitModal).length){var html="";html+='<div id="jjform_wait_message">\r\n',html+='    <div class="ajaxImage"></div>\r\n',html+='    <div class="ajaxMessage">Aguarde...</div>\r\n',html+="</div>",$(html).insertAfter($("body"));var opts,spinner=new Spinner({lines:17,length:28,width:14,radius:38,scale:.4,corners:1,color:"#000",opacity:.3,rotate:0,direction:1,speed:1.2,trail:62,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"}).spin();$(spinner.el).insertAfter($("#jjform_wait_message .ajaxImage"))}}return{show:function(){loadHtml(),$(htmlIdWaitModal).css("display","")},hide:function(){$(htmlIdWaitModal).css("display","none")}}}();class Popup{constructor(){this.modalId="popup-modal",this.modalTitleId="popup-modal-title"}setTitle(title){document.getElementById(this.modalTitleId).innerHTML=title}showModal(){if(bootstrapVersion<5)$("#"+this.modalId).modal();else{const modal=new bootstrap.Modal(document.getElementById(this.modalId),{});modal.show()}messageWait.show(),$("iframe").on("load",(function(){messageWait.hide()}))}loadHtml(url,size){let width,height,modalDialogDiv;switch($("#"+this.modalId).length&&$("#"+this.modalId).remove(),void 0===size&&(size="1"),size=parseInt(size)){case 1:width="98%",height="92%",modalDialogDiv='<div class="modal-dialog" style="margin:0.7em;left:0px;right:0px;top:0px;bottom:0px; position:fixed;width:auto;">\r\n';break;case 2:width="auto",height="95%",modalDialogDiv='<div class="modal-dialog" style="position: auto; height: 95vh;">\r\n';break;case 3:width="auto",height="75%",modalDialogDiv='<div class="modal-dialog" style="position: auto; height: 75vh;">\r\n';break;default:width="65%",height="80%",modalDialogDiv='<div class="modal-dialog" style="position: auto; height: 80vh;width:65%">\r\n'}let modalDialogCss=`\n@media (min-width: 576px) {\n  .modal-dialog { max-width: none; }\n}\n\n.modal-dialog {\n  width: ${width};\n  height: ${height};\n  padding: 0;\n}\n\n.modal-content {\n  height: 100%;\n}\n`,html="";html+='<div id="popup-modal" tabindex="-1" class="modal fade" role="dialog">\r\n',3==bootstrapVersion?html+=modalDialogDiv:($("head").append(`<style type="text/css">${modalDialogCss}</style>`),html+='<div class="modal-dialog">'),html+=3!=bootstrapVersion?'    <div class="modal-content">\r\n':'    <div class="modal-content" style="height:100%;width:auto;">\r\n',html+='      <div class="modal-header">\r\n',3==bootstrapVersion?(html+='        <button type="button" class="close" data-dismiss="modal">&times;</button>\r\n',html+='        <h4 id="popup-modal-title" class="modal-title"></h4>\r\n'):(html+='        <h4 id="popup-modal-title" class="modal-title"></h4>\r\n',html+=bootstrapVersion>=5?'        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>\r\n':'        <button type="button" class="close" data-dismiss="modal">&times;</button>\r\n'),html+="      </div>\r\n",html+='      <div class="modal-body"  style="height:90%;width:auto;">\r\n',html+='         <iframe style="border: 0px;" ',html+=" src='",html+=url,html+="' width='100%' height='97%'>Waiting...</iframe>",html+="      </div>\r\n",html+="    </div>\r\n",html+="  </div>\r\n",html+="</div>\r\n",$(html).appendTo($("body"))}show(title,url,size=4){this.loadHtml(url,size),this.setTitle(title),this.showModal()}hide(){$("#"+this.modalId).modal("hide")}modal(){return $("#"+this.modalId)}}var popup=function(){if(!(this instanceof Popup))return new Popup}(),jjutil={justNumber:function(e){var strCheck="0123456789",key="";let whichCode;return null!=e.which?whichCode=e.which:null!=e.keyCode&&(whichCode=e.keyCode),8==whichCode||0==whichCode||!(99!=whichCode&&97!=whichCode&&118!=whichCode&&120!=whichCode&&67!=whichCode&&88!=whichCode&&86!=whichCode&&65!=whichCode||!0!==e.ctrlKey&&!0!==e.metaKey)||(key=String.fromCharCode(whichCode),-1!=strCheck.indexOf(key)&&void 0)},justDecimal:function(e){var strCheck="-0123456789.,",key="";let whichCode;return null!=e.which?whichCode=e.which:null!=e.keyCode&&(whichCode=e.keyCode),8==whichCode||0==whichCode||!(99!=whichCode&&120!=whichCode&&118!=whichCode&&97!=whichCode&&67!=whichCode&&88!=whichCode&&86!=whichCode&&65!=whichCode||!0!==e.ctrlKey&&!0!==e.metaKey)||(key=String.fromCharCode(whichCode),-1!=strCheck.indexOf(key)&&void 0)},gotoNextFocus:function(currentId){var self=$("#"+currentId),form,focusable=self.parents("form:eq(0)").find("input,a.btn,select,button[type=submit]").filter(":visible"),next=focusable.eq(focusable.index(self)+1);if(next.length){if(next.is(":disabled"))for(let i=2;i<1e3&&((next=focusable.eq(focusable.index(self)+i)).is(":disabled")||!next.is(":visible"));i++);next.focus(),next.select()}},replaceEntertoTab:function(objid){$("#"+objid+" input").on("keypress",(function(e){if(13==e.keyCode)return jjutil.gotoNextFocus($(this).attr("id")),!1}))}},_a,_b,showWaitOnPost=!0,bootstrapVersion=3;const locale=null!==(_a=window.location.pathname.split("/")[1])&&void 0!==_a?_a:"pt-BR",localeCode=null!==(_b=locale.split("-")[0])&&void 0!==_b?_b:"pt";